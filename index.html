<!DOCTYPE html>
<html lang="pt-br">

<head>
  <meta charset="UTF-8">
  <title>Run Infinito 3D</title>
  <link rel="stylesheet" href="style.css">
</head>

<body>
  <div id="hud">
    <span id="score">Moedas: 0</span>
    <span id="highscore" style="margin-left: 30px;">Recorde: 0</span>
    <span id="games" style="margin-left: 30px;">Partidas: 1</span>
    <input type="file" id="loadQ" style="display:none" accept="application/json">
    <button id="loadQBtn" style="margin-left:10px;font-size:1em;">Carregar IA treinada</button>
  </div>
  <script src="https://cdn.jsdelivr.net/npm/three@0.155.0/build/three.min.js"></script>
  <script src="ai_agent.js"></script>
  <script>
    document.addEventListener('DOMContentLoaded', function () {
      document.getElementById('loadQBtn').onclick = function () {
        document.getElementById('loadQ').click();
      };
      document.getElementById('loadQ').onchange = function (e) {
        const file = e.target.files[0];
        if (!file) return;
        const reader = new FileReader();
        reader.onload = function (evt) {
          try {
            const data = JSON.parse(evt.target.result);
            if (window.aiAgent && window.aiAgent.setQTable && window.aiAgent.setMeta) {
              if (data.Q) window.aiAgent.setQTable(data.Q);
              if (data.meta) window.aiAgent.setMeta(data.meta);
              alert('IA treinada carregada com sucesso!');
              // Atualiza interface
              if (data.meta) {
                const hs = document.getElementById('highscore');
                if (hs) hs.textContent = 'Recorde: ' + (data.meta.highscore || 0);
                const g = document.getElementById('games');
                if (g) g.textContent = 'Partidas: ' + (data.meta.games || 1);
              }
            }
          } catch (err) {
            alert('Arquivo inv√°lido!');
          }
        };
        reader.readAsText(file);
      };
    });
  </script>
  <script src="game.js"></script>
</body>

</html>